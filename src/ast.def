autogen definitions ast; /* -*- mode:c -*- */

/* This is the definition file for the AST.

Copyright (C) 2014 Kieran Colford

This file is part of Compiler.

Compiler is free software; you can redistribute it and/or modify it
under the terms of the GNU General Public License as published by the
Free Software Foundation; either version 3 of the License, or (at your
option) any later version.

Compiler is distributed in the hope that it will be useful, but
WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
General Public License for more details.

You should have received a copy of the GNU General Public License
along with Compiler; see the file COPYING.  If not see
<http://www.gnu.org/licenses/>.*/

added_code = "
#include \"loc.h\"
#include <stddef.h>

#define AST_THROW_AWAY 0x1

#define AST_UNARY_PREFIX    0x20000

";

top_level = {
    type = "struct loc *";
    call = loc;
};

top_level = {
    type = int;
    call = flags;
};

top_level = {
    type = "struct ast *";
    call = next;
};

types = {
    name = block;
    sub = val;
};

types = {
    name = ret;
    sub = val;
};

types = {
    name = function;
    cont = {
	type = "char *";
	call = type;
    };
    cont = {
	type = "char *";
	call = name;
    };
    sub = args;
    sub = body;
};

types = {
    name = cond;
    sub = cond;
    sub = body;
};

types = {
    name = label;
    cont = {
	type = "char *";
	call = name;
    };
};

types = {
    name = jump;
    cont = {
	type = "char *";
	call = name;
    };
};

types = {
    name = integer;
    cont = {
	type = "long long";
	call = i;
    };
};

types = {
    name = string;
    cont = {
	type = "char *";
	call = val;
    };
};

types = {
    name = variable;
    cont = {
	type = "char *";
	call = type;
    };
    cont = {
	type = "char *";
	call = name;
    };
    extra = {
	type = int;
	call = alloc;
    };
};

types = {
    name = binary;
    cont = {
	type = int;
	call = op;
    };
    sub = left;
    sub = right;
};

types = {
    name = unary;
    cont = {
	type = int;
	call = op;
    };
    sub = arg;
};

types = {
    name = function_call;
    sub = name;
    sub = args;
};
